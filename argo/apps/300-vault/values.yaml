# Values for the vault-wrapper chart

# Values passed to the 'vault' subchart (dependency)
vault:
  # Run Vault in development mode (single node, in-memory storage - NOT FOR PRODUCTION)
  server:
    dev:
      enabled: false
    dataStorage:
      enabled: true
      size: 10Gi
      storageClass: "standard"
      accessMode: ReadWriteOnce
    standalone:
      config: |
        storage "file" {
          path = "/vault/data"
        }
        listener "tcp" {
          address     = "0.0.0.0:8200"
          tls_disable = 1
        }
        seal "file" {
          path = "/vault/unseal/unseal.key"
        }
    extraVolumes:
    - name: vault-unseal
      secret:
        secretName: vault-unseal-key
    extraVolumeMounts:
    - name: vault-unseal
      mountPath: /vault/unseal
      readOnly: true
    # Ensure HA mode is disabled when running in dev mode
    ha:
      enabled: false
      # raft: # Raft is the default integrated storage, disable if using dev mode
      #   enabled: false

      # Configure Ingress for the UI
    ingress:
      enabled: true
      # ingressClassName: traefik # Use this if you have a default IngressClass
      annotations:
        # Use Traefik's websecure entrypoint for HTTPS
        traefik.ingress.kubernetes.io/router.entrypoints: websecure
        # Enable TLS termination at the router (Traefik handles certs)
        traefik.ingress.kubernetes.io/router.tls: "true"
        # Vault UI backend service uses HTTP (port 8200)
        # traefik.ingress.kubernetes.io/service.scheme: http # Usually not needed
      hosts:
      - host: vault.cloudfleet.platform.5ha.re
      tls:
      - secretName: vault-tls
